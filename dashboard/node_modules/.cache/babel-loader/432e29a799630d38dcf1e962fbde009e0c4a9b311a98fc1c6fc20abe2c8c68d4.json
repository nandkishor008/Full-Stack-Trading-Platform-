{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\Coding\\\\WEB_D\\\\Appnacollage\\\\ZERODHA CLONE\\\\dashboard\\\\src\\\\components\\\\GeneralContext.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, createContext } from \"react\";\nimport axios from \"axios\";\nimport BuyActionWindow from \"./BuyActionWindow\";\nimport SellActionWindow from \"./SellActionWindow\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GeneralContext = /*#__PURE__*/createContext(null);\nexport const GeneralContextProvider = props => {\n  _s();\n  const [isBuyWindowOpen, setIsBuyWindowOpen] = useState(false);\n  const [isSellWindowOpen, setIsSellWindowOpen] = useState(false);\n  const [selectedStockUID, setSelectedStockUID] = useState(\"\");\n  const [holdings, setHoldings] = useState([]);\n  const [positions, setPositions] = useState([]);\n  const [orders, setOrders] = useState([]);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const fetchUser = async () => {\n      try {\n        const res = await axios.get(\"http://localhost:3002/me\", {\n          withCredentials: true\n        });\n        setUser(res.data);\n      } catch (err) {\n        console.error(\"User not authenticated.\", err);\n        setLoading(false); // Stop loading if authentication fails\n      }\n    };\n    fetchUser();\n  }, []);\n  const refreshData = async () => {\n    if (!user) return;\n    try {\n      setLoading(true); // Set loading to true before fetching data\n      const [h, p, o] = await Promise.all([axios.get(\"http://localhost:3002/api/allHoldings\", {\n        withCredentials: true\n      }), axios.get(\"http://localhost:3002/api/allPositions\", {\n        withCredentials: true\n      }), axios.get(\"http://localhost:3002/api/orders\", {\n        withCredentials: true\n      })]);\n      setHoldings(h.data);\n      setPositions(p.data);\n      setOrders(o.data);\n    } catch (error) {\n      console.error(\"Error refreshing data:\", error);\n    } finally {\n      setLoading(false); // Set loading to false after fetching is complete\n    }\n  };\n  useEffect(() => {\n    if (user) {\n      refreshData();\n    }\n  }, [user]);\n  const removeHolding = async holdingId => {\n    try {\n      if (!window.confirm(\"Are you sure you want to remove this holding? This action cannot be undone.\")) {\n        return;\n      }\n      // Call the DELETE endpoint on your backend\n      await axios.delete(`http://localhost:3002/api/holdings/${holdingId}`, {\n        withCredentials: true\n      });\n      // Refresh all the data to update the UI\n      await refreshData();\n    } catch (error) {\n      console.error(\"Error removing holding:\", error);\n      alert(\"Failed to remove the holding. Please try again.\");\n    }\n  };\n  const handleOpenBuyWindow = uid => {\n    setIsBuyWindowOpen(true);\n    setSelectedStockUID(uid);\n  };\n  const handleCloseBuyWindow = () => setIsBuyWindowOpen(false);\n  const handleOpenSellWindow = uid => {\n    setIsSellWindowOpen(true);\n    setSelectedStockUID(uid);\n  };\n  const handleCloseSellWindow = () => setIsSellWindowOpen(false);\n  return /*#__PURE__*/_jsxDEV(GeneralContext.Provider, {\n    value: {\n      openBuyWindow: handleOpenBuyWindow,\n      closeBuyWindow: handleCloseBuyWindow,\n      openSellWindow: handleOpenSellWindow,\n      closeSellWindow: handleCloseSellWindow,\n      refreshData,\n      user,\n      holdings,\n      positions,\n      orders,\n      loading,\n      removeHolding\n    },\n    children: [props.children, isBuyWindowOpen && /*#__PURE__*/_jsxDEV(BuyActionWindow, {\n      uid: selectedStockUID\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 27\n    }, this), isSellWindowOpen && /*#__PURE__*/_jsxDEV(SellActionWindow, {\n      uid: selectedStockUID\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 28\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n};\n_s(GeneralContextProvider, \"PuRNLS5csEVrbGaDh/JgJCWl6W8=\");\n_c = GeneralContextProvider;\nexport default GeneralContext;\nvar _c;\n$RefreshReg$(_c, \"GeneralContextProvider\");","map":{"version":3,"names":["React","useState","useEffect","createContext","axios","BuyActionWindow","SellActionWindow","jsxDEV","_jsxDEV","GeneralContext","GeneralContextProvider","props","_s","isBuyWindowOpen","setIsBuyWindowOpen","isSellWindowOpen","setIsSellWindowOpen","selectedStockUID","setSelectedStockUID","holdings","setHoldings","positions","setPositions","orders","setOrders","user","setUser","loading","setLoading","fetchUser","res","get","withCredentials","data","err","console","error","refreshData","h","p","o","Promise","all","removeHolding","holdingId","window","confirm","delete","alert","handleOpenBuyWindow","uid","handleCloseBuyWindow","handleOpenSellWindow","handleCloseSellWindow","Provider","value","openBuyWindow","closeBuyWindow","openSellWindow","closeSellWindow","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ASUS/Desktop/Coding/WEB_D/Appnacollage/ZERODHA CLONE/dashboard/src/components/GeneralContext.js"],"sourcesContent":["import React, { useState, useEffect, createContext } from \"react\";\r\nimport axios from \"axios\";\r\nimport BuyActionWindow from \"./BuyActionWindow\";\r\nimport SellActionWindow from \"./SellActionWindow\";\r\n\r\nconst GeneralContext = createContext(null);\r\n\r\nexport const GeneralContextProvider = (props) => {\r\n  const [isBuyWindowOpen, setIsBuyWindowOpen] = useState(false);\r\n  const [isSellWindowOpen, setIsSellWindowOpen] = useState(false);\r\n  const [selectedStockUID, setSelectedStockUID] = useState(\"\");\r\n  const [holdings, setHoldings] = useState([]);\r\n  const [positions, setPositions] = useState([]);\r\n  const [orders, setOrders] = useState([]);\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      try {\r\n        const res = await axios.get(\"http://localhost:3002/me\", {\r\n          withCredentials: true,\r\n        });\r\n        setUser(res.data);\r\n      } catch (err) {\r\n        console.error(\"User not authenticated.\", err);\r\n        setLoading(false); // Stop loading if authentication fails\r\n      }\r\n    };\r\n    fetchUser();\r\n  }, []);\r\n\r\n  const refreshData = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      setLoading(true); // Set loading to true before fetching data\r\n      const [h, p, o] = await Promise.all([\r\n        axios.get(\"http://localhost:3002/api/allHoldings\", { withCredentials: true }),\r\n        axios.get(\"http://localhost:3002/api/allPositions\", { withCredentials: true }),\r\n        axios.get(\"http://localhost:3002/api/orders\", { withCredentials: true }),\r\n      ]);\r\n      setHoldings(h.data);\r\n      setPositions(p.data);\r\n      setOrders(o.data);\r\n    } catch (error) {\r\n      console.error(\"Error refreshing data:\", error);\r\n    } finally {\r\n      setLoading(false); // Set loading to false after fetching is complete\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      refreshData();\r\n    }\r\n  }, [user]);\r\n\r\n  const removeHolding = async (holdingId) => {\r\n    try {\r\n      if (!window.confirm(\"Are you sure you want to remove this holding? This action cannot be undone.\")) {\r\n        return;\r\n      }\r\n      // Call the DELETE endpoint on your backend\r\n      await axios.delete(`http://localhost:3002/api/holdings/${holdingId}`, { withCredentials: true });\r\n      // Refresh all the data to update the UI\r\n      await refreshData();\r\n    } catch (error) {\r\n      console.error(\"Error removing holding:\", error);\r\n      alert(\"Failed to remove the holding. Please try again.\");\r\n    }\r\n  };\r\n\r\n  const handleOpenBuyWindow = (uid) => {\r\n    setIsBuyWindowOpen(true);\r\n    setSelectedStockUID(uid);\r\n  };\r\n  const handleCloseBuyWindow = () => setIsBuyWindowOpen(false);\r\n  const handleOpenSellWindow = (uid) => {\r\n    setIsSellWindowOpen(true);\r\n    setSelectedStockUID(uid);\r\n  };\r\n  const handleCloseSellWindow = () => setIsSellWindowOpen(false);\r\n\r\n  return (\r\n    <GeneralContext.Provider\r\n      value={{\r\n        openBuyWindow: handleOpenBuyWindow,\r\n        closeBuyWindow: handleCloseBuyWindow,\r\n        openSellWindow: handleOpenSellWindow,\r\n        closeSellWindow: handleCloseSellWindow,\r\n        refreshData,\r\n        user,\r\n        holdings,\r\n        positions,\r\n        orders,\r\n        loading,\r\n        removeHolding, \r\n      }}\r\n    >\r\n      {props.children}\r\n      {isBuyWindowOpen && <BuyActionWindow uid={selectedStockUID} />}\r\n      {isSellWindowOpen && <SellActionWindow uid={selectedStockUID} />}\r\n    </GeneralContext.Provider>\r\n  );\r\n};\r\n\r\nexport default GeneralContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}